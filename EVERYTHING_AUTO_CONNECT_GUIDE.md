# Everything 自动连接功能使用指南

## 功能概述

本应用现在支持一键自动连接Everything搜索引擎的HTTP服务，无需手动配置！

## 主要功能

### 🚀 一键连接Everything服务

自动完成以下步骤：
1. **自动搜索系统中的Everything安装位置**
   - 通过Windows注册表搜索
   - 搜索常见安装路径（Program Files等）
   - 搜索桌面快捷方式
   - 支持便携版和安装版

2. **智能进程管理**
   - 检测并优雅关闭现有Everything进程
   - 避免配置冲突

3. **自动配置HTTP服务**
   - 修改Everything.ini配置文件
   - 启用HTTP服务器
   - 自动选择可用端口（优先8080、8888等）
   - 移除用户名密码认证（简化访问）

4. **自动启动服务**
   - 重新启动Everything
   - 等待HTTP服务启动
   - 验证连接状态

## 使用方法

### 方法一：一键连接（推荐）

1. 打开应用设置（点击右下角⚙️按钮）
2. 滚动到"Everything 设置"部分
3. 点击"🔗 一键连接Everything服务"按钮
4. 等待自动配置完成（约30-60秒）
5. 查看连接结果和配置信息

### 方法二：手动设置路径

如果自动搜索失败，可以手动设置：

1. 点击"📁 手动设置路径"按钮
2. 输入Everything的路径：
   - `C:\Program Files\Everything\Everything.exe` （完整exe路径）
   - `C:\Program Files\Everything` （安装目录）
   - `C:\Program Files` （上级目录，会自动搜索）
3. 点击"确认设置"

## 支持的路径格式

应用智能识别以下三种路径格式：

1. **Everything.exe完整路径**
   ```
   C:\Program Files\Everything\Everything.exe
   D:\Software\Everything\Everything.exe
   ```

2. **Everything安装目录**
   ```
   C:\Program Files\Everything
   D:\Software\Everything
   ```

3. **安装目录的上级路径**
   ```
   C:\Program Files
   D:\Software
   ```

## 连接进度显示

应用会实时显示连接进度：
- ⏳ 准备阶段
- 🔄 正在处理
- ✅ 成功完成
- ❌ 出现错误

## 配置信息

连接成功后，可以在"当前配置"部分查看：
- **HTTP端口**: 服务运行的端口号
- **安装路径**: Everything的安装位置

## 故障排除

### 如果自动搜索失败

1. 确保Everything已正确安装
2. 尝试使用"手动设置路径"功能
3. 检查用户权限（可能需要管理员权限）

### 如果HTTP服务启动失败

1. 检查防火墙设置
2. 确保端口未被其他程序占用
3. 尝试以管理员身份运行应用

### 如果连接超时

1. 等待更长时间（某些情况下启动可能较慢）
2. 手动启动Everything后再尝试
3. 检查系统资源使用情况

## 技术特性

- **智能路径识别**: 支持多种路径格式输入
- **端口自动选择**: 优先选择8080、8888等常用端口
- **进程安全管理**: 优雅关闭和启动，避免数据丢失
- **配置备份**: 自动备份原始配置
- **实时状态监控**: 30秒间隔检查连接状态
- **兼容性**: 支持Everything 1.4及以上版本

## 注意事项

1. **管理员权限**: 某些操作可能需要管理员权限
2. **防病毒软件**: 可能需要将应用添加到白名单
3. **网络安全**: HTTP服务仅绑定到localhost（127.0.0.1）
4. **数据安全**: 不会修改您的搜索索引，仅配置HTTP访问

## 系统要求

- Windows 10/11
- Everything 1.4或更高版本
- .NET Framework 4.5+（Everything依赖）

---

享受快速的本地文件搜索体验！🔍✨